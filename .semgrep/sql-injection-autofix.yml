rules:
  - id: sql-injection-autofix
    name: Detect and fix SQL injection via string concatenation
    languages: [java]
    severity: ERROR
    message: |
      SQL injection vulnerability detected. Use parameterized queries instead of string concatenation.
    pattern: |
      $STMT = $CONN.createStatement();
      String $SQL = "SELECT * FROM $TABLE WHERE username = '" + $USER + "'";
      ResultSet $RS = $STMT.executeQuery($SQL);
    fix: |
      PreparedStatement stmt = $CONN.prepareStatement("SELECT * FROM $TABLE WHERE username = ?");
      stmt.setString(1, $USER);
      ResultSet $RS = stmt.executeQuery();
    metadata:
      category: security
      cwe: "CWE-89"
      technology: java
      autofix: true
