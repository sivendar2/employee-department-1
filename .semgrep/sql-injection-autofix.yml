rules:
  - id: sql-injection-autofix
    languages: [java]
    severity: ERROR
    message: "Potential SQL injection: use PreparedStatement instead."
    pattern: |
      Statement $STMT = $DB.createStatement();
      String $SQL = "SELECT" + ... + $VAR + ...;
      ResultSet $RS = $STMT.executeQuery($SQL);
    fix: |
      PreparedStatement stmt = $DB.prepareStatement("SELECT ... WHERE column = ?");
      stmt.setString(1, $VAR);
      ResultSet $RS = stmt.executeQuery();
    metadata:
      category: security
